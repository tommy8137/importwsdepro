const { expect } = require('chai')
const sinon = require('sinon')
const math = require('mathjs')
const partListService = require('../../../server/service/bom/partList')

const priceDataString = '{"housingMetal":{"hmInputBomLevel":null,"hmItem":"23","hmpartname":"Housing Matel","hmpartnumber":null,"hmmaterial":"AL5052","hmmaterialdensity":0,"cmfProcessPrice":0,"cmfProcessDensity":0,"hmthickness":"1.2","hmpartssizewidth":"378","hmpartssizelength":"261","hmpartssizehigh":"4.8","hmpartsexpandwidth":"388","hmpartsexpandlength":"271","hmStandOff":"2","hmRivetCount":"4","hmTappingCount":"6","hmSelfriveCount":"8","hmHoleCount":10,"hmmaterialprice":4.3,"hmToolingMaterialWidth":5,"hmToolingMaterialLength":5,"hmToolingMaterialExpandWidth":393,"hmToolingMaterialExpandLength":276,"hmToolingIntervalPrice":0.12,"hmToolingWeight":346.98839999999996,"hmToolingMaterialWeight":357.9444,"hmToolingHoleCount":1,"hmToolingStageDieCount":10,"hmToolingStageDiePress":"160T","hmToolingStageDieModuleCost":0.0103,"hmToolingProgressiveDieCount":6,"hmToolingProgressiveDieStation":6,"hmToolingProgressiveDiePress":"400T","hmToolingProgressiveDieModuleCost":0.018,"hmToolingRivetingDieCount":5,"hmToolingRivetingDiePress":"80T","hmToolingRivetingDieModuleCost":0.0103,"hmToolingTotalCount":21,"hmToolingModuleMode":"連續模+工程模+鉚合模","hmToolingModuleFeature":"修改for 新機種","hmToolingModuleFactory":"聖美","hmToolingMoldingManufacturer":"CNP","hmToolingSource":"WCQ","hmToolingPayout":"WCQ","hmToolingBonded":"非保稅","hmToolingTSDate":"2019-09-24 ","hmToolingT1Date":null,"hmToolingRemark":null,"cmfProcessListultrasonicCleanExist":true,"cmfProcessListFirstAnodeCheckBox":true,"cmfProcessListFirstAnodeColor":"銀色","cmfProcessListFirstAnodePrice":0,"cmfProcessListSecondAnodeCheckBox":true,"cmfProcessListSecondAnodeColor":"鋁本色","cmfProcessListSecondAnodePrice":0,"cmfProcessListSecondAnode":"預陽","cmfProcessListSandBlastCheckBox":true,"cmfProcessListSandBlastSide":"雙面","cmfProcessListSandBlastSideCount":0,"cmfProcessListHairLineCheckBox":true,"cmfProcessListHairLineArea":70000,"cmfProcessListPaintingCheckBox":true,"cmfProcessListPaintingTypeAndColor":"液體漆：(Pike Silver 1 coat PU)","CmfProcessListPaintingPriceUSD":0,"CmfProcessListPaintingPriceRMB":0,"cmfProcessListPaintingArea":79451.5,"cmfProcessListPaintingFilmThickness":0.08,"cmfProcessListPaintingCount":1,"cmfProcessListPaintingColor":"黑","cmfProcessListThermalBondingCheckBox":true,"cmfProcessListThermalBondingGlueType":"DEVCON DV14167","cmfProcessListThermalBondingGluePrice":0,"cmfProcessListThermalBondingGlueDensity":0,"cmfProcessListThermalBondingPathLength":2500,"cmfProcessListThermalBondingGlueSyringeDiameter":0.6,"cmfProcessListThermalBondingGlueWeight":0.7,"cmfProcessListThermalBondingCycleTime":"90sec","cmfProcessListThermalBondingCycleTimePrice":null,"cmfProcessListThermalBondingCycleTimeValue":null,"cmfProcessListSingleTappingCheckBox":true,"cmfProcessListSingleTappingCount":2,"cmfProcessListMultiTappingCheckBox":true,"cmfProcessListMultiTappingCount":3,"cmfProcessListSingleSpotWeldingCheckBox":true,"cmfProcessListSingleSpotWeldingCount":4,"cmfProcessListMultiSpotWeldingCheckBox":true,"cmfProcessListMultiSpotWeldingCount":5,"cmfProcessListPopRivetCheckBox":false,"cmfProcessListPopRivetCount":0,"cmfProcessListRivetCheckBox":true,"cmfProcessListRivetCount":3,"cmfProcessListHandMakeDrawCheckBox":true,"cmfProcessListHandMakeDrawCount":2000,"cmfProcessListScreenPrintingCheckBox":true,"cmfProcessListScreenPrintingCount":6,"cmfProcessListPadPrintingCheckBox":true,"cmfProcessListPadPrintingCount":7,"cmfProcessListSilkPrintCheckBox":true,"cmfProcessListSilkPrintCount":8,"cmfProcessListCNCCheckBox":true,"cmfProcessListCNCArea":900,"cmfProcessListCNCPLCheckBox":true,"cmfProcessListCNCPLLength":240,"cmfProcessListDrillCutCheckBox":true,"cmfProcessListDrillCutArea":175,"cmfProcessListLaserPrintCheckBox":true,"cmfProcessListLaserPrintArea":5000,"cmfProcessListLaserPrintIconCheckBox":true,"cmfProcessListLaserPrintIconCount":11,"cmfProcessListPolishingAutoCheckBox":true,"cmfProcessListPolishingAutoArea":106000,"cmfProcessListPolishingArtificialCheckBox":true,"cmfProcessListPolishingArtificialArea":12800,"cmfProcessListPolishingSpeed":0,"cmfProcessListPolishingPrice":0,"cmfProcessListDrillingCheckBox":true,"cmfProcessListDrillingCount":5400,"cmfProcessListAnodizingRemovalCheckBox":true,"cmfProcessListAnodizingRemovalCount":3,"cmfProcessListSingleRivetCheckBox":true,"cmfProcessListSingleRivetCount":1,"cmfProcessListMultiRivetCheckBox":true,"cmfProcessListMultiRivetCount":1}}'

/*
describe('PartList - housing-metal', () => {
  it('v2 - price', async () => {
    const layout = partListService.getPartListLayout('housing-metal')
    /*
    const calResult = partListService.calPartlistPrice(
      { Price: JSON.parse(priceDataString) },
      layout.formulas,
      layout.layout
    )


    expect(math.round(calResult.totalPrices || -99, 4)).to.equal(9.7012)
  })
})
*/